# HTTP

## 基本概念

* HTTP：**超文本传输协议**
  * 协议：HTTP确立了一种计算机交流通信的规范
  * 传输：HTTP是双向协议，用于在两点之间传输数据
  * 超文本：文字、图片、音视频等
* 常见状态码
  * `1xx`：提示类消息
  * `2xx`：成功处理请求
    * `200`：一切正常
    * `204`：同200基本相同，但是响应头没有body数据
    * `206`：分块下载/断点续传
  * `3xx`：客户端请求的资源发生变动，需要重定向
    * `301`：永久重定向
    * `302`：临时重定向
    * `304`：换成重定向
  * `4xx`：客户端发送的**报文有误**
    * `400`：报文有误，笼统概述
    * `403`：服务器禁止访问资源
    * `404`：请求资源未找到
  * `5xx`：服务器内部发生错误
    * `500`：笼统错误码
    * `501`：请求的功能不支持
    * `502`：服务器正常，后端访问服务器发送错误
    * `503`：服务器繁忙
* HTTP常见字段
  * 客户端

    * Host：指定服务器域名 `Host: www.A.com`
    * Connection：要求服务器使用长连接机制 `Connection: Keep-Alive`
      * 长连接：任意一端没有明确提出断开连接，则保持TCP连接状态
    * Accept：声明客户端能接受的格式 `Accept: */*`接受任何格式
  * 服务器

    * Content-Length：本次回应的数据长度 `Content-Length: 1000`
    * Content-type：回应客户端的数据格式
      * `Content-Type: text/html; Charset=utf-8`：发送的是网页，编码是UTF-8
    * Content-Encoding：说明数据压缩方法

## GET和POST

* **GET 是从服务器获取指定的资源**
* ****POST 根据请求负荷（报文body）对指定的资源做出处理****
* 安全性和幂等性
  * 安全性：请求方法不会破坏服务器上的资源。
  * 幂等性：意思是多次执行相同的操作，结果都是相同的。
  * GET 方法是安全且幂等的，可以缓存
  * POST 方法不是安全且幂等的

## HTTP缓存技术

* 缓存方式
  * 强制缓存
  * 协商缓存
* 强制缓存
  * 只要浏览器判断缓存没有过期，则直接使用浏览器的本地缓存
  * 使用Cache-Control或Expires头部，表示有效时间
* 协商缓存
  * 与服务端协商之后，通过协商结果来判断是否使用本地缓存
* 协商缓存两种实现方式
  * Last-Modified与If-Modified-Since
    * 响应头部中的Last-Modified表示相应资源最后的修改时间
    * 请求头部中的If-Modified-Since：资源过期时，如果响应头中有Last-Modified，则再次发送请求时带上Last-Modified的时间，服务器收到后和Last-Modified进行对比，根据时间大小返回200或304
  * If-None-Match与ETag
    * 响应头部中 `Etag`：唯一标识响应资源
    * 请求头部中的 `If-None-Match`：当资源过期时，浏览器发现响应头里有 Etag，则再次向服务器发起请求时，会将请求头 If-None-Match 值设置为 Etag 的值。服务器收到请求后进行比对，返回200或304
* ETag优先级更高
  * 不修改内容，文件也可能被修改
  * 文件在秒级内被多次修改
  * 有些服务器不能精确获取文件最后修改时间

![1763435480136](image/基础面试题/1763435480136.png)

## HTTP/1.1

* 优点
  * 简单：header+body
  * 易扩展
  * 应用广泛
* 缺点
  * 无状态：完成关联性操作麻烦
  * 明文传输
  * 不安全
* 性能
  * 长连接
  * 管道网络传输
    * HTTP/1.1解决了请求的队头堵塞，但是没有解决响应的队头堵塞
  * 性能一般

## HTTP和HTTPS

* HTTPS 解决 HTTP 不安全的问题，在 TCP 和 HTTP 网络层之间加入了 SSL/TLS 安全协议
* HTTPS需要在TCP三次握手后再进行SSL/TLS的握手过程
* 解决的问题
  * 窃听：信息加密
  * 篡改：校验机制
  * 冒充：身份证书
* 混合加密
  * 解决窃听风险
  * 对称加密+非对称加密
* 摘要算法+数字签名
  * 解决篡改风险
  * 无法解决替换问题，需要解密
* 数字证书
  * 解决身份冒充问题
* TLS握手

## HTTP/1.1 HTTP/2 HTTP/3

* HTTP/1.1
  * 长连接
  * 请求/响应头部未压缩就发送了，延迟大
  * 首部浪费
  * 没有优先级控制
  * 服务器只能被动响应
* HTTP/2
  * 头部压缩
  * 二进制形式报文
  * 并发传输
  * 服务器主动推送
  * 依旧存在队头阻塞问题
* HTTP/3
  * TCP改为UDP，基于QUIC实现类似的可靠传输
  * QUIC
    * 无队头阻塞
    * 连接建立更快
    * 连接迁移
