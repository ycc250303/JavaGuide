# 键入网址到网页显示

## HTTP

* 解析URL，确定Web服务器和文件名
  * URL实际上是服务器里面的文件资源
* 生成HTTP请求，发送请求报文（GET POST）

## DNS真实地址查询

* DNS 中的域名都是用句点分隔的，域名的层级关系类似一个树状结构

  * 根 DNS 服务器（.）
  * 顶级域 DNS 服务器（.com）
  * 权威 DNS 服务器（server.com）
* 域名解析：

  * 发送DNS请求，询问域名的IP地址，并发给本地DNS服务器
  * 本地服务器收到请求
    * 缓存中能找到，返回IP地址
    * 找不到，询问根域名服务器
  * 根DNS收到请求，发送顶级域名服务器的地址
  * 本地DNS，向顶级域名服务器请求
  * 顶级域名服务器收到请求，发送权威域名服务器的地址
  * 本地DNS，向权威域名服务器请求
  * 权威DNS查询后返回对应的IP地址
  * 本地DNS将IP地址返回客户端，客户端和目标建立连接

![1763168975712](image/小林/1763168975712.png)

## 协议栈

* 通过 DNS 获取到 IP 后，就可以把 HTTP 的传输工作交给操作系统中的 **协议栈** 。
* 浏览器通过Socket库委托协议栈工作
* 协议栈上半部分是TCP和UDP协议，下半部分是IP协议
* IP协议还包括ICMP协议和ARP协议
  * ICMP用于告知错误和控制信息
  * ARP用于查询以太网MAC地址

## TCP

* TCP包头格式

  ![1763169370134](image/小林/1763169370134.png)
* 序号，解决乱序问题
* 确认号，确认对方是否收到，解决丢包问题
* **状态位** ，`SYN` 是发起一个连接，`ACK` 是回复，`RST` 是重新连接，`FIN` 是结束连接。


* TCP三次握手

![1763169464189](image/小林/1763169464189.png)

* 建立连接后，网络包报文：TCP头部+HTTP报文

## IP
